SWIFTCMSAgent Task ChecklistStep-by-Step Instructions for All 8 Agents × 4 WavesCompanion to: SwiftCMS Master Plan V2READ THE GLOBAL RULES BEFORE WRITING ANY CODEDO NOT EDIT FILES OUTSIDE YOUR ASSIGNED DIRECTORIESFebruary 2026  •  Version 2.0Table of ContentsTOC \h \o &quot;1-3&quot;Global Rules — Read This First⚠ EVERY AGENT MUST READ THIS ENTIRE SECTION BEFORE WRITING A SINGLE LINE OF CODE. VIOLATIONS WILL CAUSE MERGE FAILURES.Swift &amp; Toolchain✔TaskDetails / Acceptance Criteria☐Swift versionSwift 5.10 or later. Use async/await and Sendable. Do NOT use Swift 5.x callback patterns.☐Vapor versionVapor 4.x (latest). Import: .package(url: &quot;https://github.com/vapor/vapor.git&quot;, from: &quot;4.89.0&quot;)☐PlatformCode MUST compile on macOS AND Linux (Ubuntu 24.04). Do NOT use Foundation APIs that are macOS-only (e.g., NSImage, URLSession.shared on Linux needs specific import).☐Package managerSPM only. No CocoaPods, Carthage, or .xcodeproj files. Agent 1 (W1) owns Package.swift.☐Minimum deployment.macOS(.v13) in Package.swift platforms array.Coding Standards✔TaskDetails / Acceptance Criteria☐TypesUpperCamelCase. Example: ContentTypeDefinition, AuthProvider, CmsEvent.☐Properties &amp; functionslowerCamelCase. Example: contentType, jsonSchema, validateEntry().☐FilesMatch the primary type. ContentTypeDefinition.swift contains ContentTypeDefinition.☐ProtocolsDescriptive nouns/adjectives. AuthProvider, FileStorageProvider. Do NOT suffix with Protocol.☐DTOsSuffix with DTO. Example: CreateContentEntryDTO. ALL DTOs live in Sources/CMSObjects/ only.☐Access controlpublic for protocols, DTOs, API types. internal for implementation. private for helpers.☐Async/awaitUse async/await for ALL async ops. NEVER use EventLoopFuture or callbacks.☐Error handlingThrow Abort(.notFound), Abort(.badRequest, reason: &quot;...&quot;). Use AbortError for HTTP errors.☐SendableALL types shared across concurrency boundaries MUST be Sendable.☐Doc comments/// on ALL public types, properties, methods. Include @param for non-obvious functions.☐No force unwrapNEVER use ! to unwrap. Use guard let, if let, or ?? with defaults.☐No print()Use req.logger.info() / .warning() / .error(). NEVER print() in production code.☐ImportsOne import per line, sorted alphabetically. Import only what you need.Vapor &amp; Fluent Patterns✔TaskDetails / Acceptance Criteria☐RoutesUse RouteCollection protocol. Group related routes. Register in routes.swift.☐Fluent models@ID(key: .id) var id: UUID? for all PKs. Use @Field, @OptionalField, @Timestamp, @Parent.☐MigrationsOne per file. Name: Create{Table}.swift. Always implement prepare() AND revert() (DROP TABLE).☐JSONB columnsUse .custom(&quot;JSONB&quot;) for PostgreSQL. Type as [String: AnyCodableValue] in models.☐Database accessUse req.db in handlers. Use app.db ONLY in migrations, seeds, and boot() lifecycle.☐Content conformanceModels/DTOs returned in responses MUST conform to Content (Vapor protocol).☐ValidationUse Validatable protocol on request DTOs. Validate BEFORE database operations.☐Middleware orderErrorMiddleware &gt; Sessions &gt; CORS &gt; RateLimit &gt; Auth &gt; Custom. ORDER MATTERS.Git &amp; Collaboration Rules✔TaskDetails / Acceptance Criteria☐Branch namingwave-{N}/agent-{N}-{short-desc}. Example: wave-1/agent-3-database-models☐Commit messages[Agent-N] Module: Description. Example: [Agent-3] CMSSchema: Add content_entries migration☐STAY IN YOUR LANEONLY create/edit files in your assigned directories. Need a change elsewhere? Write it in HANDOFF.md.☐HANDOFF.mdFor cross-module requests. Format: [Agent-N needs] What, Which file, Why. Agent 8 resolves these.☐Package.swiftAgent 1 (W1) owns this. Need a new dependency? Add request to HANDOFF.md.☐TestsWrite unit tests for your module in Tests/{Module}Tests/. Minimum: 1 test per public function.Directory Ownership MapThis is the exact structure. Each row shows the directory and which agent owns it in which wave.✔TaskDetails / Acceptance Criteria☐Sources/App/Agent 1 (W1). Entry point, configure.swift, routes.swift.☐Sources/CMSCore/Agent 2 (W1). Module system, hooks, Application extensions.☐Sources/CMSSchema/Agent 3 (W1) creates models/migrations. Agent 1 (W2) adds Engine/. Grows per wave with subdirs.☐Sources/CMSApi/REST/Agent 2 (W2). Dynamic content + content type REST controllers.☐Sources/CMSApi/GraphQL/Agent 1 (W3). Graphiti schema + Pioneer integration.☐Sources/CMSAdmin/Agent 3 (W2). Admin controllers. Resources/Views/admin/ for Leaf templates.☐Sources/CMSAuth/Agent 4 (W1) creates protocol + Auth0. Agent 5 (W2) adds Firebase + Local.☐Sources/CMSMedia/Agent 4 (W2). File storage, uploads, thumbnails.☐Sources/CMSSearch/Agent 6 (W2). Meilisearch integration.☐Sources/CMSEvents/Agent 6 (W1). EventBus, event types. Agent 7 (W2) extends with webhook dispatcher.☐Sources/CMSJobs/Agent 7 (W2). Vapor Queues job definitions.☐Sources/CMSObjects/Agent 5 (W1). ALL shared DTOs. Others import, NEVER modify.☐Sources/CMSCLI/Agent 6 (W1) creates foundation. Agent 1 (W4) adds codegen. Agent 3 (W4) adds migration.☐Modules/Agent 2 (W4). Plugin directory.☐Tests/Agent 8 (all waves). Test infrastructure. Other agents add module-specific tests in their dirs.☐Docker/CI filesAgent 7 (W1). Dockerfile, docker-compose.yml, k8s/, .github/workflows/.☐HANDOFF.mdANY agent can append. Agent 8 reads and resolves during integration.Shared Type Contracts (All Agents Depend On These)These types are defined by Agent 5 (W1) and Agent 2 (W1). Every agent codes against them. If you need a change, use HANDOFF.md.Protocols✔TaskDetails / Acceptance Criteria☐CmsModulename: String, priority: Int, register(app:), boot(app:), shutdown(app:). Default empty impls via extension.☐AuthProvidername: String, configure(app:), verify(token:, on req:) -&gt; AuthenticatedUser, middleware() -&gt; AsyncMiddleware.☐AuthenticatedUseruserId: String, email: String?, roles: [String], tenantId: String?. Conforms to Authenticatable, Sendable.☐EventBuspublish(event:, context:), subscribe(type:, handler:) -&gt; UUID, unsubscribe(id:).☐CmsEventstatic var eventName: String. Conforms to Codable, Sendable.☐FileStorageProviderupload(key:, data:, contentType:) -&gt; String, download(key:) -&gt; ByteBuffer, delete(key:), publicURL(key:) -&gt; String.Key DTOs✔TaskDetails / Acceptance Criteria☐AnyCodableValueEnum: .string, .int, .double, .bool, .array([Self]), .dictionary([String:Self]), .null. Custom Codable. This represents ALL JSONB columns.☐PaginationWrapper&lt;T: Content&gt;data: [T], meta: PaginationMeta { page, perPage, total, totalPages }. Generic wrapper for all list endpoints.☐ApiErrorerror: true, statusCode: Int, reason: String, details: [String:String]?. Conforms to AbortError + Content.  WAVE 1 — Foundation &amp; Core Infrastructure (Weeks 1–3)Goal: Server boots, connects PostgreSQL + Redis, authenticates Auth0 JWT, /healthz returns 200, module system + EventBus work.AGENT 1: PROJECT BOOTSTRAPYOU OWN: Sources/App/, Package.swift, docker-compose.yml, .env.example, Makefile   |   Master Plan Ref: Master Plan §3: Monorepo Structure✔TaskDetails / Acceptance Criteria☐Create Package.swiftSwift 5.10+, .macOS(.v13). ALL deps: vapor, fluent, fluent-postgres-driver, fluent-sqlite-driver, jwt-kit v5, leaf, redis, queues-redis-driver, Graphiti, Pioneer, kylef/JSONSchema.swift, soto-s3, swift-argument-parser, VaporHX. Define internal targets matching directory structure.☐Create Sources/App/entrypoint.swift@main struct entry point. Call configure(app) then try await app.execute().☐Create Sources/App/configure.swiftLoad .env. Configure Fluent with PostgreSQL (DATABASE_URL) + SQLite fallback. Configure Redis (REDIS_URL). Configure Leaf. Configure sessions (Redis). Register migrations. Register routes.☐Create Sources/App/routes.swiftGET /healthz -&gt; 200 OK. GET /ready -&gt; check DB + Redis, 200 or 503. GET /startup -&gt; 200. Group /api/v1/ and /admin/.☐Create docker-compose.ymlpostgres:16 (port 5432), redis:7 (port 6379), meilisearch:latest (port 7700). Volumes for persistence.☐Create .env.exampleDATABASE_URL, REDIS_URL, AUTH_PROVIDER=auth0, AUTH0_DOMAIN, AUTH0_AUDIENCE, MEILI_URL, MEILI_KEY, STORAGE_PROVIDER=local, S3_BUCKET, S3_REGION, APP_URL=http://localhost:8080☐Create MakefileTargets: build, run, test, docker-up, docker-down, migrate, seed, clean.☐Verify swift build succeedsZero errors. All targets compile (even with empty placeholder files).AGENT 2: CORE MODULE SYSTEMYOU OWN: Sources/CMSCore/   |   Master Plan Ref: Master Plan §3 + §10: Plugin API✔TaskDetails / Acceptance Criteria☐CmsModule.swiftProtocol: name, priority (default 0), register(app:), boot(app:), shutdown(app:). Default empty impls via extension.☐ModuleManager.swiftHolds [CmsModule]. Methods: register(_:), bootAll(app:) sorts by priority then calls register on all then boot on all, shutdownAll(app:). Store on Application via StorageKey.☐HookRegistry.swiftGeneric: register&lt;T&gt;(hookName:, handler:), invoke&lt;T&gt;(hookName:, args:). Calls all handlers for that hook in registration order.☐Application+CMS.swiftExtensions: app.cms.modules, app.cms.hooks, app.cms.eventBus. Use Application.Storage with StorageKey pattern.☐Request+CMS.swiftExtensions: req.cms.eventBus, req.cms.hooks. Delegate to Application instances.☐TestsTests/CMSCoreTests/: TestModule, test registration, boot order, hook invocation with typed args.AGENT 3: DATABASE MODELS &amp; MIGRATIONSYOU OWN: Sources/CMSSchema/Models/, Sources/CMSSchema/Migrations/   |   Master Plan Ref: Master Plan §11: Database Design✔TaskDetails / Acceptance Criteria☐User.swiftid (UUID), email (unique), passwordHash (optional), displayName, roleId (@Parent), authProvider, externalId (optional), tenantId (optional), createdAt, updatedAt.☐Role.swiftid, name, slug (unique), description (optional), isSystem (Bool, default false).☐Permission.swiftid, roleId (@Parent), contentTypeSlug, action (create|read|update|delete|publish|configure). Composite unique.☐ApiKey.swiftid, name, keyHash, permissions (JSONB), lastUsedAt (optional), expiresAt (optional), tenantId, createdAt.☐MediaFile.swiftid, filename, mimeType, sizeBytes, storagePath, provider (local|s3), altText (optional), metadata (JSONB), tenantId, createdAt.☐Webhook.swiftid, name, url, events (JSONB array), headers (JSONB optional), secret, enabled, retryCount (default 5), tenantId, createdAt.☐WebhookDelivery.swiftid, webhookId (@Parent), event, payload (JSONB), idempotencyKey (unique), responseStatus (optional), attempts (default 0), deliveredAt (optional), createdAt.☐DeadLetterEntry.swiftid, jobType, payload (JSONB), failureReason, retryCount, firstFailedAt, lastFailedAt.☐AuditLog.swiftid, entryId (optional), contentType (optional), action, userId (optional), beforeData (JSONB optional), afterData (JSONB optional), tenantId, createdAt.☐ContentTypeDefinition.swiftid, name, slug (unique), displayName, description (optional), kind (collection|single), jsonSchema (JSONB), fieldOrder (JSONB), settings (JSONB optional), tenantId, createdAt, updatedAt.☐ContentEntry.swiftid, contentType (String), data (JSONB), status (draft|review|published|archived), locale (optional), publishAt (optional), unpublishAt (optional), createdBy, updatedBy, tenantId, createdAt, updatedAt, publishedAt (optional), deletedAt (optional soft delete).☐ContentVersion.swiftid, entryId (@Parent), version (Int), data (JSONB), changedBy (optional), createdAt.☐ALL migrationsOne per table. Name: Create{Table}.swift. Both prepare() and revert(). GIN index on content_entries.data, B-tree on (tenant_id, content_type). Guard for SQLite (skip GIN).☐SeedDefaultRoles.swiftCreates: Super Admin (isSystem:true), Editor, Author, Public. Default admin user from ADMIN_EMAIL/ADMIN_PASSWORD env vars.☐TestsTests/CMSSchemaTests/: Model creation for each type. Migration up/down on SQLite.AGENT 4: AUTH0 PROVIDERYOU OWN: Sources/CMSAuth/   |   Master Plan Ref: Master Plan §6: Authentication Architecture✔TaskDetails / Acceptance Criteria☐AuthProvider.swift protocolname, configure(app:), verify(token:, on req:) -&gt; AuthenticatedUser, middleware() -&gt; AsyncMiddleware. SHARED protocol.☐AuthenticatedUser.swiftProtocol + concrete CmsUser struct. userId, email, roles, tenantId. Conforms to Authenticatable, Sendable.☐Auth0Provider.swiftconfigure: fetch JWKS from https://{AUTH0_DOMAIN}/.well-known/jwks.json, add to app.jwt.keys. verify: decode Auth0TokenPayload, check exp. Middleware: JWTBearerAuthenticator.☐Auth0TokenPayload.swiftJWTPayload: iss, sub, exp, aud, permissions ([String] optional). verify() checks exp.☐FirebaseProvider.swift STUBThrow Abort(.notImplemented, reason: &quot;Coming in Wave 2&quot;). Agent 5 (W2) fills in.☐LocalJWTProvider.swift STUBSame stub. Wave 2.☐RBACMiddleware.swiftGet CmsUser from req.auth. Extract contentType + action from route. Query permissions table. Abort(.forbidden) if no match. Skip for Super Admin.☐SessionAuthMiddleware.swiftFor admin. SessionsMiddleware + ModelSessionAuthenticatable. Redirect /admin/login if no session.☐ApiKeyMiddleware.swiftExtract from X-API-Key header. Hash + lookup. Check expiry. Map to synthetic CmsUser.☐AuthProviderFactory.swiftRead AUTH_PROVIDER env. Return correct provider instance.☐TestsToken payload decode. RBAC allow/deny. API key validation.AGENT 5: SHARED DTOS &amp; OBJECTSYOU OWN: Sources/CMSObjects/   |   Master Plan Ref: Master Plan §3: CMSObjects✔TaskDetails / Acceptance Criteria☐AnyCodableValue.swiftEnum: .string, .int, .double, .bool, .array([Self]), .dictionary([String:Self]), .null. Custom Codable encode/decode. Sendable, Equatable, Content. THIS IS THE MOST CRITICAL TYPE.☐ContentTypeDefinitionDTO.swiftCreateContentTypeDTO (name, slug, displayName, kind, jsonSchema, fieldOrder, settings), UpdateContentTypeDTO (all optional), ContentTypeResponseDTO (all + id + timestamps). All Content.☐ContentEntryDTO.swiftCreateContentEntryDTO (data, status?, locale?, publishAt?), UpdateContentEntryDTO (all optional), ContentEntryResponseDTO (all + id + contentType + timestamps). All Content.☐PaginationWrapper.swiftGeneric PaginationWrapper&lt;T: Content&gt;: Content { data: [T], meta: PaginationMeta }. PaginationMeta: page, perPage, total, totalPages.☐ApiError.swifterror: true, statusCode, reason, details. Conforms to AbortError + Content.☐UserDTO.swiftUserResponseDTO (id, email, displayName, roleName, authProvider, createdAt). Create + Update variants.☐RoleDTO.swift + PermissionDTO.swiftRoleResponseDTO (id, name, slug, description, isSystem, permissions). PermissionDTO (contentTypeSlug, action).☐MediaFileDTO.swiftMediaResponseDTO (id, filename, mimeType, sizeBytes, url, altText, metadata, createdAt).☐WebhookDTO.swiftWebhookResponseDTO + CreateWebhookDTO + WebhookDeliveryDTO.☐TestsAnyCodableValue roundtrip encode/decode for every case. Nested dict/array. PaginationWrapper serialization.AGENT 6: EVENTBUS &amp; CLI FOUNDATIONYOU OWN: Sources/CMSEvents/, Sources/CMSCLI/ (foundation)   |   Master Plan Ref: Master Plan §4: Event &amp; Webhook Architecture✔TaskDetails / Acceptance Criteria☐CmsEvent.swiftprotocol CmsEvent: Codable, Sendable { static var eventName: String { get } }☐CmsContext.swiftStruct: db (Database), logger (Logger), userId (String?), tenantId (String?).☐EventBus.swift protocolpublish(event:, context:), subscribe(type:, handler:) -&gt; UUID, unsubscribe(id:).☐InProcessEventBus.swiftActor-based. Store handlers as [String: [(UUID, handler)]]. Publish calls all handlers for event name. Thread-safe via actor.☐RedisStreamsEventBus.swift STUBpublish() XADDs to Redis Stream cms:{eventName}. Subscribe/processing stubbed with TODOs for Wave 2.☐Core event typesContentCreatedEvent, ContentUpdatedEvent, ContentDeletedEvent, ContentPublishedEvent, ContentStateChangedEvent, SchemaChangedEvent, UserLoginEvent. Each conforms to CmsEvent.☐CMSCLI main.swiftArgumentParser root command. Subcommands: ServeCommand, MigrateCommand, SeedCommand.☐TestsInProcessEventBus publish/subscribe roundtrip. Multiple subscribers receive same event. Unsubscribe stops delivery.AGENT 7: DOCKER &amp; CI/CDYOU OWN: Dockerfile, k8s/, .github/workflows/   |   Master Plan Ref: Master Plan §3: Infrastructure Layer✔TaskDetails / Acceptance Criteria☐DockerfileMulti-stage. Build: FROM swift:5.10-jammy, swift build -c release. Runtime: FROM ubuntu:24.04, install libcurl4 libxml2 libz, copy binary, EXPOSE 8080. Target ~200MB.☐.dockerignore.build/, .git/, *.xcodeproj, DerivedData/, Tests/, *.md, .env☐docker-compose.yml (app service)Add app service building from Dockerfile, depends_on postgres+redis, port 8080, loads .env, healthcheck on /healthz.☐k8s/deployment.yaml2 replicas, port 8080, livenessProbe /healthz, readinessProbe /ready, startupProbe /startup. Resources: 256Mi/250m request, 512Mi/500m limit.☐k8s/service.yaml + hpa.yamlClusterIP port 80-&gt;8080. HPA 70% CPU, min 2, max 10.☐k8s/configmap.yaml + secret.yamlNon-secret config vs base64 secrets template.☐.github/workflows/ci.ymlOn push/PR. ubuntu-latest, setup Swift 5.10, start PostgreSQL+Redis services, swift build, swift test. Cache .build.☐.github/workflows/docker.ymlOn tag v*. Build + push to ghcr.io.☐Health check testTests/IntegrationTests/HealthCheckTests.swift: XCTVapor boot, GET /healthz 200, /ready 200, /startup 200.AGENT 8: INTEGRATION &amp; TESTINGYOU OWN: Tests/, HANDOFF.md resolution, final merge   |   Master Plan Ref: Master Plan §13: Wave 1⚠ YOU ARE LAST. Wait for all 7 agents to complete their branches.✔TaskDetails / Acceptance Criteria☐Test infrastructureTests/AppTests/configure.swift: XCTApplicationTester with SQLite in-memory. Register + apply all migrations.☐Test helpersTests/Helpers/TestFixtures.swift: Factory methods for User, Role, Permission, ContentType, ContentEntry with defaults.☐Read HANDOFF.mdProcess ALL cross-module requests. Make edits. Document what changed.☐Merge order1 (bootstrap) &gt; 5 (DTOs) &gt; 2 (core) &gt; 6 (events) &gt; 3 (models) &gt; 4 (auth) &gt; 7 (devops). This minimizes conflicts.☐Fix compilationswift build after merge. Fix import errors, missing types, protocol conformance.☐Run full testsswift test must pass with zero failures.☐Verify Dockerdocker compose build + up. curl /healthz returns 200.☐Smoke testTests/IntegrationTests/SmokeTests.swift: boot, /healthz 200, module registered, EventBus pub/sub works.☐Taggit tag wave-1-complete on merged main.EXIT CRITERIA: Server boots → PostgreSQL + Redis → Auth0 JWT works → /healthz 200 → module system → EventBus pub/sub → Docker builds → CI green.  WAVE 2 — Content Engine &amp; API Layer (Weeks 4–6)Goal: Functional headless CMS. Define content types, create entries via REST, admin panel, media upload, search, webhooks.AGENT 1: CONTENT TYPE ENGINEYOU OWN: Sources/CMSSchema/Engine/   |   Master Plan Ref: Master Plan §3: Core Engine Layer✔TaskDetails / Acceptance Criteria☐FieldTypeRegistry.swiftMap field type strings to JSON Schema fragments. 14 types: shortText, longText, richText, integer, decimal, boolean, dateTime, email, enumeration, json, media, relationHasOne, relationHasMany, component.☐SchemaGenerator.swiftTakes field definitions (name, type, required, unique, default, enum values) -&gt; complete JSON Schema (type:object, properties, required). Stored in content_type_definitions.json_schema.☐SchemaValidator.swiftWraps kylef/JSONSchema.swift. validate(data, against schema) throws [ValidationError] with field paths.☐ContentTypeService.swiftCRUD for type definitions. Create: validate slug unique, generate schema, save, fire SchemaChangedEvent. Delete: check no entries (or force).☐ContentEntryService.swiftCRUD for entries. Create: lookup type, validate against schema, set status=draft, save, fire ContentCreatedEvent. Update: validate, save, create version, fire event. Delete: soft delete.☐RelationResolver.swiftResolve relation fields on ?populate= param. hasOne: UUID -&gt; nested object. hasMany: UUID[] -&gt; nested array. Depth limit: 2.☐TestsSchemaGenerator validity. Validator catches bad data. ContentTypeService CRUD with events. RelationResolver.AGENT 2: REST API CONTROLLERSYOU OWN: Sources/CMSApi/REST/   |   Master Plan Ref: Master Plan §3: API Layer✔TaskDetails / Acceptance Criteria☐DynamicContentController.swiftRouteCollection at /api/v1/:contentType. GET / (list), POST / (create), GET /:id (read), PUT /:id (update), DELETE /:id (delete). :contentType resolves against content_type_definitions.☐List endpointParams: page, perPage (max 100), sort (field:asc|desc), filter (field[eq|contains|gt|lt]=val), fields (sparse), populate (relations), status. Return PaginationWrapper.☐Create endpointDecode CreateContentEntryDTO. Lookup type. Validate data vs JSON Schema. Set createdBy. Save. Fire event. Return 201.☐Read endpointFetch by UUID. Support ?populate=. Return DTO or 404.☐Update endpointValidate. Set updatedBy. Save. Create version. Fire event. Return DTO.☐Delete endpointSoft delete (set deletedAt). Fire event. Return 204.☐ContentTypeController.swiftAt /api/v1/content-types. CRUD for type definitions. Protected by configure permission.☐Auth middlewarePublic: GET if Public role has read. Protected: POST/PUT/DELETE require auth + permissions.☐TestsE2E: create type, create 3 entries, list with pagination, filter, sort, update, soft delete. Auth 401/403.AGENT 3: ADMIN PANEL COREYOU OWN: Sources/CMSAdmin/, Resources/Views/admin/   |   Master Plan Ref: Master Plan Admin Panel Design✔TaskDetails / Acceptance Criteria☐base.leafHTML5 layout. Tailwind (CDN), DaisyUI (CDN), HTMX (CDN), Alpine.js (CDN). Sidebar: Dashboard, Content Types, dynamic per-type links, Media, Users, Webhooks, Settings. Top bar: user + logout.☐AdminController.swiftRouteCollection at /admin. All routes SessionAuthMiddleware protected.☐DashboardCards: content type count, total entries, recent entries (last 10), system health.☐Content type builderbuilder.leaf: Name, slug (auto from name), kind dropdown. Dynamic field list (Alpine.js x-data). Add/remove/reorder fields. SortableJS drag-drop. HTMX submit to POST /api/v1/content-types.☐Content listlist.leaf: Parameterized by :contentType. Columns from field_order. Pagination (HTMX). Search. Status badges. Create button.☐Content editedit.leaf: Dynamic form from JSON Schema. Inputs by type. TipTap for richText. HTMX submit.☐Login pagelogin.leaf: Email + password. POST /admin/login. Success: redirect /admin. Failure: error msg.☐VaporHX configAuto-detect HX-Request. HTMX requests: return #content partial. Full: return base.leaf.☐TestsEach admin page 200 with session, 302 without.AGENT 4: MEDIA LIBRARYYOU OWN: Sources/CMSMedia/   |   Master Plan Ref: Master Plan §3: CMSMedia✔TaskDetails / Acceptance Criteria☐FileStorageProvider.swiftProtocol: upload(key:,data:,contentType:)-&gt;URL, download(key:)-&gt;ByteBuffer, delete(key:), publicURL(key:)-&gt;String.☐LocalStorageProvider.swiftStore in Public/uploads/. publicURL: /uploads/{key}. Create dirs as needed.☐S3StorageProvider.swiftSoto S3Client. putObject, getObject, deleteObject. Presigned URLs (1hr expiry). Read S3_* env vars.☐MediaService.swiftValidate type (allowlist: jpg,png,gif,webp,svg,pdf,mp4,mp3,doc,docx), validate size (max 50MB default), generate key (uploads/{year}/{month}/{uuid}-{filename}), upload, create record, return DTO.☐MediaController.swiftAt /api/v1/media. POST / (multipart), GET / (list+filter), GET /:id, DELETE /:id. Auth protected.☐Thumbnail jobThumbnailJob: for images, generate 300px thumbnail via ImageMagick CLI. Store at uploads/thumbs/. Update metadata.☐Admin media pagelibrary.leaf: Grid with thumbnails. Upload modal (HTMX drag-drop). Search. Filter by type.☐TestsLocalStorage roundtrip. Validation (reject .exe, accept .png). Size limit.AGENT 5: FIREBASE &amp; LOCAL AUTHYOU OWN: Sources/CMSAuth/Firebase/, Sources/CMSAuth/Local/   |   Master Plan Ref: Master Plan §6: Auth Providers✔TaskDetails / Acceptance Criteria☐FirebaseProvider.swiftConfigure: fetch Google X.509 certs, parse Cache-Control for refresh interval, schedule periodic refresh. Verify: validate JWT sig, check iss/aud/exp. Map customClaims.roles to CmsUser.roles.☐LocalJWTProvider.swiftConfigure: HMAC-SHA256 from JWT_SECRET env. Login endpoint POST /api/v1/auth/login: email+password, verify bcrypt, issue JWT (24h). Refresh endpoint.☐User management adminusers/list.leaf: table (email, role, provider, last login). users/edit.leaf: edit displayName, role dropdown, disable/enable.☐Admin login controllerPOST /admin/login: for local auth verify DB. For Auth0/Firebase redirect to hosted login. Create session on success.☐TestsLocalJWT login (correct -&gt; token, wrong -&gt; 401). Token verify. Firebase key caching (mock HTTP).AGENT 6: SEARCH INTEGRATIONYOU OWN: Sources/CMSSearch/   |   Master Plan Ref: Master Plan §3: CMSSearch✔TaskDetails / Acceptance Criteria☐MeilisearchService.swiftWrap meilisearch-swift. Configure from MEILI_URL + MEILI_KEY. Methods: createIndex, updateIndex, deleteIndex, indexEntry, removeEntry, search.☐Index managementSubscribe to SchemaChangedEvent: created -&gt; create index + configure searchable fields. Updated -&gt; update attributes. Deleted -&gt; delete index.☐Content syncSubscribe to ContentCreated/Updated/Deleted. On create/update: flatten JSONB, index with id/contentType/status/locale. On delete: remove.☐SearchController.swiftAt /api/v1/search. GET ?q=query&amp;type=articles&amp;page=1&amp;perPage=20. Returns PaginationWrapper.☐Admin search barHTMX input in base.leaf header. Queries /admin/search?q=. Returns dropdown of results linking to edit pages.☐TestsIndex CRUD (needs Meilisearch from Docker). Search returns results. Hooks fire on entry creation.AGENT 7: WEBHOOKS &amp; BACKGROUND JOBSYOU OWN: Sources/CMSWebhooks/, Sources/CMSJobs/   |   Master Plan Ref: Master Plan §4: Event &amp; Webhook Architecture✔TaskDetails / Acceptance Criteria☐Vapor Queues configAdd to HANDOFF.md for Agent 8: app.queues.use(.redis(url:)). Register job types. Start workers.☐WebhookDispatcher.swiftSubscribe to ALL CmsEvents. Match events to webhooks (where events array contains eventName AND enabled). Generate idempotency key. Check dedup (60s). Create WebhookDelivery. Enqueue job.☐WebhookDeliveryJob.swiftQueueJob. Fetch delivery+webhook. JSON payload (event, timestamp, data). HMAC-SHA256 sign with secret -&gt; X-SwiftCMS-Signature. POST to URL (10s timeout). Success: update status. Failure: increment attempts, re-enqueue with delay (30s * 2^attempt), or DLQ after max retries.☐ScheduledPublishJob.swiftRuns every 60s. Query draft entries with publish_at &lt;= now. Transition to published. Fire ContentPublishedEvent. Also check unpublish_at.☐SearchReindexJob.swiftReceives contentTypeSlug. Batch-index ALL entries for that type into Meilisearch.☐Webhook admin pageslist.leaf, edit.leaf (URL, event checkboxes, headers, secret), deliveries.leaf (log with retry button).☐DLQ admin pagesystem/dlq.leaf: dead letter entries, retry/purge buttons.☐TestsDispatcher matches events to webhooks. Idempotency dedup. Retry logic. ScheduledPublishJob transitions.AGENT 8: INTEGRATION &amp; TESTINGYOU OWN: Tests/, final merge   |   Master Plan Ref: Master Plan §13: Wave 2⚠ Merge order: 1 (engine) &gt; 6 (search) &gt; 4 (media) &gt; 7 (webhooks) &gt; 2 (REST) &gt; 3 (admin) &gt; 5 (auth). Fix after each.✔TaskDetails / Acceptance Criteria☐HANDOFF.mdResolve all. Especially: Queues config in configure.swift, route registration, migration ordering.☐Content type e2e testCreate Article type (title string required, body richText, date dateTime). Create 3 entries. List with pagination. Filter by title. Validate rejects missing title.☐Media e2e testUpload PNG multipart. Verify record. Verify file at URL. Delete -&gt; 404.☐Webhook e2e testCreate webhook for content.created. Create entry. Verify WebhookDelivery record.☐Admin smoke testsGET dashboard, content-types, media, webhooks -&gt; 200 with session, 302 without.☐Performance baselineCreate 10K entries. Measure list endpoint (target &lt;200ms). Document.☐Docker full stackdocker compose up. Create type via admin. Create entry via REST. Search finds it. Webhook fires.☐Tagwave-2-complete.EXIT CRITERIA: Create Blog Post type via admin → 3 entries via REST → pagination → image upload → search works → webhook fires → DLQ captures failures → Docker full stack.  WAVE 3 — Production Readiness (Weeks 7–10)Goal: Production-grade with GraphQL, content lifecycle, relations, i18n, caching, security, observability.AGENT 1: GRAPHQL APIYOU OWN: Sources/CMSApi/GraphQL/   |   Master Plan Ref: Master Plan §3: API Layer + GraphQL Layer✔TaskDetails / Acceptance Criteria☐Schema auto-generationRead all content_type_definitions. For each: Graphiti Type with fields from JSON Schema. String-&gt;GraphQL String, integer-&gt;Int, boolean-&gt;Boolean. Relations-&gt;nested types.☐Pioneer integrationRegister at /graphql (HTTP) and /graphql/ws (WebSocket subscriptions). GraphiQL IDE at /graphql/ide. Pass auth context from Vapor request to resolver context.☐Query resolversPer type: single by ID, list with pagination/filter args. Respect RBAC permissions.☐Mutation resolverscreate, update, delete. Validate via SchemaValidator. Fire events.☐Subscription resolversonChange per content type. Push via EventBus subscription forwarded to WebSocket.☐Schema regeneration hookSubscribe to SchemaChangedEvent. Rebuild + hot-swap Graphiti schema in Pioneer.☐TestsCreate type, query via GraphQL, create via mutation, verify subscription fires.AGENT 2: CONTENT LIFECYCLE (DRAFT/PUBLISH)YOU OWN: Sources/CMSSchema/Workflow/   |   Master Plan Ref: Master Plan §5: Content Lifecycle✔TaskDetails / Acceptance Criteria☐ContentStateMachine.swiftEnum: draft, review, published, archived, deleted. allowedTransitions(from:) returns valid targets. Enforce on every status change.☐Status transitions in serviceValidate transition allowed. Set publishedAt on publish. Fire ContentStateChangedEvent (fromState, toState).☐Preview endpointGET /api/v1/:contentType/:id/preview?token=... Returns draft without publish. Token: short-lived JWT (1hr) from POST .../preview-token.☐Admin status controlsPublish/Unpublish/Archive buttons per current state. Scheduled publish date picker. Transition history.☐TestsAll valid transitions succeed. Invalid -&gt; 422. ScheduledPublishJob works. Preview token access.AGENT 3: CONTENT RELATIONSYOU OWN: Sources/CMSSchema/Relations/   |   Master Plan Ref: Master Plan Relations✔TaskDetails / Acceptance Criteria☐hasOneUUID in JSONB. On ?populate=field, resolve to nested ContentEntryResponseDTO.☐hasManyUUID array in JSONB. Resolve all to nested array.☐Circular detectionTrack visited IDs during resolution. Cycle detected -&gt; return UUID not nested. Max depth: 2.☐Admin relation pickerHTMX modal: search target type entries, select one/many. Show as removable chips.☐TestsAuthor + Article types. Article has author (hasOne). Create both, populate works. Circular stops.AGENT 4: INTERNATIONALIZATIONYOU OWN: Sources/CMSSchema/I18n/   |   Master Plan Ref: Master Plan i18n✔TaskDetails / Acceptance Criteria☐Locale supportEntries use locale column. API ?locale=en-US. Default locale from settings if unspecified.☐Fallback chainEntry not found in locale -&gt; fall back to default. Configurable chains (en-GB -&gt; en-US -&gt; en).☐Translation adminSide-by-side: original left, target right. Copy-from-original button. Locale switcher in header.☐Locale managementsettings/locales.leaf: Add/remove locales, set default, configure fallbacks.☐TestsCreate en-US. Request fr-FR -&gt; falls back. Create fr-FR translation -&gt; returns French.AGENT 5: CACHING &amp; PERFORMANCEYOU OWN: Sources/App/Middleware/Cache/   |   Master Plan Ref: Master Plan §8: Performance✔TaskDetails / Acceptance Criteria☐ResponseCacheMiddlewareGET content endpoints: cache key from URL+params+locale. Redis check. Hit: return + Age header. Miss: handler + cache with TTL (5min list, 15min single).☐Invalidation via hooksSubscribe to content mutation events. Invalidate all keys matching content type slug via Redis SCAN.☐ETag supportMD5 hash of response body. If-None-Match -&gt; 304 Not Modified if match.☐Pool tuningDB_POOL_SIZE (default 10) and REDIS_POOL_SIZE (default 5) from env vars.☐TestsCache hit faster. Mutation invalidates. ETag 304.AGENT 6: SECURITY &amp; OBSERVABILITYYOU OWN: Sources/App/Middleware/Security/   |   Master Plan Ref: Master Plan §3: Infrastructure✔TaskDetails / Acceptance Criteria☐CORS middlewareALLOWED_ORIGINS env (comma-sep). Allow GET/POST/PUT/DELETE/OPTIONS. Headers: Authorization, Content-Type, X-API-Key.☐Security headersX-Content-Type-Options: nosniff, X-Frame-Options: DENY (API) / SAMEORIGIN (admin), HSTS max-age=31536000, Referrer-Policy: strict-origin-when-cross-origin.☐Rate limitingGatekeeper + Redis. Public: 60/min. Authenticated: 300/min. Admin: unlimited. 429 + Retry-After.☐Request IDUUID per request. X-Request-Id header. Logger metadata.☐swift-otelOpenTelemetry OTLP/gRPC. Request duration histogram, count counter, error counter. Trace context on outgoing HTTP.☐Audit log writesSubscribe to mutation events. AuditLog entry: entryId, action, userId, before/after data, tenantId.☐TestsCORS headers present. Rate limit triggers. Request ID in response. Audit log created.AGENT 7: ADMIN PANEL POLISHYOU OWN: Sources/CMSAdmin/ (refinements)   |   Master Plan Ref: Master Plan Admin Design✔TaskDetails / Acceptance Criteria☐Dark modeDaisyUI theme toggle (light/dark). localStorage preference. data-theme attribute.☐ResponsiveSidebar -&gt; hamburger on mobile. Tables scroll horizontal. Forms stack vertical.☐Bulk operationsCheckbox column in lists. Select all in header. Bulk action bar: Publish/Delete Selected. HTMX submit.☐Import/exportExport type definition as JSON. Import JSON to create type. Validate on import.☐Activity dashboardRecent Activity feed: last 20 audit log entries with user, action, type, timestamp.☐Role managementroles/ pages. Permission matrix: types as rows, actions as columns, checkboxes.☐TestsSmoke tests for all new pages. Bulk delete creates audit entries.AGENT 8: LOAD TESTING &amp; INTEGRATIONYOU OWN: Tests/, Benchmarks/   |   Master Plan Ref: Master Plan §8: Performance Targets⚠ Merge order: 5 (cache) &gt; 6 (security) &gt; 4 (i18n) &gt; 3 (relations) &gt; 2 (lifecycle) &gt; 1 (GraphQL) &gt; 7 (admin).✔TaskDetails / Acceptance Criteria☐HANDOFF + mergeProcess all requests. Merge in order above. Fix integration.☐Load test suitewrk/k6: GET /api/v1/articles cached 1000req/s 30s. Uncached 10K entries. 50 concurrent writers. Document p50/p95/p99/errors.☐RBAC matrix testAll 4 roles x all content types x all actions. Verify allow/deny matches expected permissions.☐GraphQL integrationNested relation queries. Mutation with validation. Subscription receives events.☐Migration pathEmpty DB -&gt; all migrations -&gt; seed -&gt; all endpoints work.☐Security scanDependency audit. Verify security headers. Rate limiting functional.☐Tagwave-3-complete.EXIT CRITERIA: GraphQL + subscriptions → draft/published + scheduled → relations + populate → i18n + fallback → cached &lt;50ms p99 → rate limiting → 1000 req/sec → audit log.  WAVE 4 — Ecosystem &amp; Developer Experience (Weeks 11–14)Goal: Developer platform. SDK gen, plugins, Strapi migration, versioning, WebSocket, static export, docs.AGENT 1: CLIENT SDK GENERATORYOU OWN: Sources/CMSCLI/Codegen/   |   Master Plan Ref: Master Plan §9: Apple Differentiators✔TaskDetails / Acceptance Criteria☐SwiftSDKGenerator.swiftRead content_type_definitions. Per type: Codable struct (string-&gt;String, int-&gt;Int, bool-&gt;Bool, dateTime-&gt;Date, relation-&gt;UUID?). Generated client class with async list/get/create/update/delete.☐TypeScriptGenerator.swiftSame logic -&gt; .d.ts interface per type.☐Package.swift generatorGenerate complete SPM package in ClientSDK/ with Package.swift, Sources, README.☐Schema hash versioningSHA256 of all schemas combined -&gt; static let schemaVersion. Client staleness detection.☐CLI commands&apos;cms generate-sdk swift --output ./ClientSDK&apos; + &apos;cms generate-sdk typescript --output ./client-types&apos;.☐TestsCreate type with 5 field types. Generate SDK. Compile generated package. Types match schema.AGENT 2: PLUGIN MARKETPLACEYOU OWN: Modules/, Sources/CMSCore/Plugins/   |   Master Plan Ref: Master Plan §10: Plugin API✔TaskDetails / Acceptance Criteria☐Plugin manifestplugin.json: name, version, description, author, dependencies, hooks, adminPages, fieldTypes.☐Plugin discoveryOn boot: scan Modules/ for plugin.json. Validate. Load as CMSModule. Respect dependency order.☐Plugin admin pageplugins/list.leaf: installed plugins, version, active/inactive toggle.☐SEO example pluginModules/SEO/: CMSModule. Routes: /sitemap.xml, /robots.txt. Widget: % entries with meta. Hook: afterSave auto-generates meta_description.☐Analytics example pluginModules/Analytics/: Track API hits per type per day. Chart.js dashboard widget.☐TestsDiscovery loads manifest. SEO generates valid sitemap. Analytics records hits.AGENT 3: STRAPI MIGRATION TOOLYOU OWN: Sources/CMSCLI/Migration/   |   Master Plan Ref: Master Plan Strapi Migration✔TaskDetails / Acceptance Criteria☐StrapiSchemaParser.swiftRead schema.json from src/api/*/content-types/*/. Map Strapi types (string,text,richtext,integer,float,boolean,datetime,enum,media,relation) to SwiftCMS. Generate ContentTypeDefinitionDTO.☐StrapiDataImporter.swiftRead Strapi JSON export. Map entries to content_entries format. Preserve IDs.☐Migration reportMarkdown: types migrated (field mapping), entries per type, unmapped fields (manual attention), media files, users/roles.☐CLI command&apos;cms import-strapi --path ./strapi-project&apos;. ArgumentParser subcommand.☐TestsSample schema.json fixtures. Correct type definitions generated. Field mapping covers all Strapi types.AGENT 4: CONTENT VERSIONINGYOU OWN: Sources/CMSSchema/Versioning/   |   Master Plan Ref: Master Plan §5: Version History✔TaskDetails / Acceptance Criteria☐VersionService.swiftOn ContentUpdatedEvent: create ContentVersion (auto-increment version, full data snapshot, user). Methods: listVersions, getVersion, restoreVersion (creates new version from historical).☐Version API endpointsGET /:contentType/:id/versions (list). GET .../versions/:version (single). POST .../versions/:version/restore.☐Version diffCompare two snapshots: added/removed/changed fields with before/after values. Structured JSON.☐Admin version pagecontent/versions.leaf: Version list. Compare two versions with visual diff (green/red/yellow highlighting).☐Retention + pruningVersionPruningJob (daily). max_versions (50), max_age_days (365). Always keep version 1 + current.☐TestsCreate, update 3x -&gt; 3 versions. Restore v1 -&gt; data matches. Diff v1 vs v3. Pruning respects limits.AGENT 5: WEBSOCKET &amp; STATIC EXPORTYOU OWN: Sources/App/WebSocket/, Sources/CMSCLI/Export/   |   Master Plan Ref: Master Plan §9: Static Export✔TaskDetails / Acceptance Criteria☐WebSocket serverVapor WebSocket at /ws. Auth via ?token= query param JWT. On connect: subscribe to EventBus. Forward content events as JSON messages. Track active connections.☐Channel subscriptionsClients send JSON { subscribe: contentType } to filter events. Only receive events for subscribed types.☐Admin real-timeHTMX SSE or WebSocket: notify admin panel of changes by other users. Show toast notifications.☐Static export CLI&apos;cms export --format=static-json --output ./bundles --locale en-US&apos;. Generate /bundles/{locale}/{contentType}/{slug}.json. Only published. ExportManifest.json with hashes. Incremental: --since timestamp.☐TestsWebSocket connect + subscribe + receive event. Static export generates correct file structure. Incremental only includes changes.AGENT 6: ADVANCED ADMIN FEATURESYOU OWN: Sources/CMSAdmin/Advanced/   |   Master Plan Ref: Master Plan Admin✔TaskDetails / Acceptance Criteria☐Content type duplicationClone a type definition with all fields. Generate new slug. Admin button.☐Field-level permissions UIPer-role field visibility/editability toggles. Stored in role settings JSONB.☐Dashboard widgetsChart.js content statistics: entries created per day, popular types bar chart.☐API explorerEmbed Swagger UI at /admin/api-explorer. Auto-generated OpenAPI spec from content types.☐Saved presetsSave filter/sort combinations per content type. Dropdown to apply. Stored in user settings.☐BrandingSettings page: upload logo, pick primary color, custom CSS. Applied to admin layout.☐TestsDuplication creates correct new type. Chart data endpoint returns valid JSON.AGENT 7: DOCUMENTATIONYOU OWN: README.md, docs/, examples/   |   Master Plan Ref: Master Plan Documentation✔TaskDetails / Acceptance Criteria☐README.mdQuick start (5 min), feature list, architecture overview, badges (CI, license, Swift version).☐docs/ guidesInstallation, configuration, content types, authentication (Auth0/Firebase/Local), deployment (Docker/K8s), plugin development, migration from Strapi.☐API referenceAuto-generated from OpenAPI spec. Host via SwaggerUI or Redoc.☐Example: Blog + SwiftUIexamples/blog-swiftui/: SwiftCMS config + SwiftUI iOS app consuming generated SDK.☐Example: E-commerce catalogexamples/ecommerce/: Product + Category types with relations.☐Contributing guideCONTRIBUTING.md: fork, branch, PR process. Code of conduct. How to create plugins.☐TestsVerify all doc links resolve. Example projects compile.AGENT 8: FINAL INTEGRATION &amp; RELEASEYOU OWN: Tests/, Scripts/, .github/   |   Master Plan Ref: Master Plan Release⚠ This is the FINAL integration. Everything must be perfect for v1.0.0.✔TaskDetails / Acceptance Criteria☐Merge all Wave 4 branchesOrder: 1 (SDK) &gt; 2 (plugins) &gt; 3 (migration) &gt; 4 (versioning) &gt; 5 (WS+export) &gt; 6 (admin) &gt; 7 (docs).☐Full journey e2e testCreate type -&gt; create entries -&gt; query REST -&gt; query GraphQL -&gt; generate SDK -&gt; compile SDK -&gt; consume in test -&gt; verify types match.☐Strapi import e2eImport sample Strapi project. Verify types, entries, and media migrated correctly.☐Plugin e2eInstall SEO plugin. Create content. Verify sitemap.xml generated. Meta description auto-filled.☐Release automationSemantic versioning script. CHANGELOG.md generation from commit messages. GitHub release action.☐Homebrew formulaFormula for &apos;brew install swiftcms&apos; that installs the CLI tool.☐DocC generationGenerate Swift API documentation via DocC for all public types.☐Performance regressionRe-run Wave 3 load tests. Verify no regression from Wave 4 additions.☐Tag v1.0.0Create annotated tag. Draft release notes. Announce.EXIT CRITERIA: SDK compiles → Strapi import works → SEO plugin functions → versions show diffs → WebSocket delivers → static export for iOS → docs complete → v1.0.0 tagged.— End of Checklist —For detailed architecture context, refer to SwiftCMS Master Plan V2